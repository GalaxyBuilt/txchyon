---
// src/pages/index.astro - FIXED VERSION with proper dark/light mode classes
import { getCollection } from 'astro:content';
import Base from "@/layouts/Base.astro";
import Posts from "@/layouts/components/Posts.astro";
import Pagination from "@/layouts/components/Pagination.astro";
import { CATEGORY_HIERARCHY } from '@/lib/categories';

// Helper function for automatic readTime calculation
function calculateReadTime(content, wordsPerMinute = 130) {
  if (!content) return 10;
  
  const plainText = content
    .replace(/---[\s\S]*?---/, '')
    .replace(/```[\s\S]*?```/g, '')
    .replace(/<[^>]*>/g, '')
    .replace(/#{1,6}\s*/g, '')
    .replace(/[\[\]\(\)]/g, ' ')
    .replace(/\s+/g, ' ')
    .trim();
  
  const wordCount = plainText.split(/\s+/).length;
  const minutes = Math.ceil(wordCount / wordsPerMinute);
  
  return Math.max(1, Math.min(minutes, 60));
}

function getPostReadTime(post) {
  if (post.data.readTime) return post.data.readTime;
  if (post.body) return calculateReadTime(post.body);
  
  const estimates = {
    'getting-started': 8,
    'security-privacy': 10,
    'trading-investing': 12,
    'defi-yield': 15,
    'airdrop-farming': 12,
    'infrastructure-tech': 14,
    'tools-automation': 13,
    'research-analysis': 15,
    'regulatory-tax': 12,
    'portfolio-management': 12,
    'prediction-markets': 14
  };
  
  return estimates[post.data.category] || 10;
}

const allPostsRaw = await getCollection('posts', ({ data }) => !data.draft);
const allPosts = allPostsRaw.map(post => ({
  ...post,
  data: {
    ...post.data,
    readTime: getPostReadTime(post)
  }
}));

const sortedPosts = allPosts.sort(
  (a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime()
);

const featuredPost = sortedPosts[0];
const latestPosts = sortedPosts.slice(1, 8);

const categoryPosts = {};
const categoryPostCounts = {};

Object.keys(CATEGORY_HIERARCHY).forEach(category => {
  const allPostsInCategory = sortedPosts.filter(p => p.data.category === category);
  categoryPostCounts[category] = allPostsInCategory.length;
  categoryPosts[category] = allPostsInCategory
    .filter(p => p.slug !== featuredPost?.slug)
    .slice(0, 3);
});

const gettingStartedPosts = sortedPosts
  .filter(p => p.data.category === 'getting-started' && p.slug !== featuredPost?.slug);

let quickWins;
if (gettingStartedPosts.length >= 4) {
  quickWins = gettingStartedPosts.slice(0, 4);
} else {
  const otherPosts = sortedPosts
    .filter(p => p.slug !== featuredPost?.slug)
    .slice(0, 4 - gettingStartedPosts.length);
  quickWins = [...gettingStartedPosts, ...otherPosts].slice(0, 4);
}

if (!quickWins || quickWins.length === 0) {
  quickWins = sortedPosts.slice(0, 4);
}

const realisticStats = {
  guidesPublished: allPosts.length.toString(),
  activeReaders: "1,200+",
  protocolsCovered: "45+",
  monthsActive: "1"
};
---

<Base title="Txchyon - Free DeFi Mastery | No Gatekeeping, Just Knowledge" 
      description="Premium DeFi education that should cost thousands... but we're giving it away free. Because crypto knowledge should be accessible to everyone">
  
  <!-- 🌟 SPACE-THEMED HERO SECTION -->
  <section class="relative min-h-[85vh] overflow-hidden dark:bg-gradient-to-br dark:from-gray-900 dark:via-black dark:to-blue-950 bg-gradient-to-br from-blue-50 via-white to-cyan-50">
    <!-- Space Background for Dark Mode -->
    <div class="absolute inset-0 bg-black hidden dark:block">
      <!-- Stars Container -->
      <div class="absolute inset-0">
        <!-- Static Stars -->
        <div class="stars"></div>
        <div class="stars stars-2"></div>
        <div class="stars stars-3"></div>
        
        <!-- Animated Shooting Stars -->
        <div class="shooting-star"></div>
        <div class="shooting-star shooting-star-2"></div>
        <div class="shooting-star shooting-star-3"></div>
        
        <!-- Nebula/Galaxy Effect -->
        <div class="absolute w-[800px] h-[800px] bg-gradient-to-r from-purple-500/5 via-blue-500/5 to-cyan-500/5 rounded-full blur-3xl top-1/4 left-1/4 animate-pulse-slow"></div>
        <div class="absolute w-[600px] h-[600px] bg-gradient-to-r from-blue-500/5 via-cyan-500/5 to-purple-500/5 rounded-full blur-3xl bottom-1/4 right-1/4 animate-pulse-slower"></div>
        
        <!-- Tachyon Particle Effects -->
        <div class="particle-field">
          <!-- Fast moving particles (tachyons) -->
          <div class="particle particle-fast"></div>
          <div class="particle particle-fast particle-fast-2"></div>
          <div class="particle particle-fast particle-fast-3"></div>
          
          <!-- Slow moving particles -->
          <div class="particle particle-slow"></div>
          <div class="particle particle-slow particle-slow-2"></div>
          <div class="particle particle-slow particle-slow-3"></div>
        </div>
      </div>
    </div>
    
    <!-- Light Mode: Hero image background -->
    <div class="absolute inset-0 dark:hidden">
      <img
        src="/images/posts/txchyafinal.jpg"
        alt="Txchyon Hero"
        class="absolute inset-0 w-full h-full object-cover"
        loading="eager"
      />
      <!-- Overlay to ensure text readability -->
      <div class="absolute inset-0 bg-gradient-to-br from-white/75 via-white/60 to-white/60"></div>
      <!-- Subtle texture overlay -->
      <div class="absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-blue-50/30 via-transparent to-transparent"></div>
    </div>
    
    <div class="container relative z-10 mx-auto px-4 pt-28 pb-16">
      <div class="max-w-5xl mx-auto text-center">
        
        {/* Honest Badge */}
        <div class="inline-flex items-center gap-2 dark:bg-black/40 bg-white/80 backdrop-blur-sm dark:border border-cyan-500/30 border-cyan-400/30 rounded-full px-5 py-2.5 mb-8">
          <span class="text-cyan-500 dark:text-cyan-400">⚡</span>
          <span class="text-cyan-600 dark:text-cyan-300 font-medium text-sm">
            FRESH LAUNCH • NO BULLSHIT • 100% FREE
          </span>
        </div>
        
        {/* Main Headline */}
        <h1 class="text-4xl md:text-6xl lg:text-7xl font-black text-center mb-8 leading-tight">
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 via-purple-500 to-pink-500 dark:from-cyan-400 dark:via-purple-400 dark:to-pink-400 animate-gradient">
            DeFi Knowledge
          </span>
          <br />
          <span class="dark:text-white text-gray-900 text-3xl md:text-5xl lg:text-6xl">
            Shouldn't Cost $5,000
          </span>
        </h1>
        
        {/* Subheadline */}
        <p class="text-xl md:text-2xl dark:text-gray-300 text-gray-700 mb-10 max-w-3xl mx-auto">
          We're giving away what "gurus" charge thousands for. 
          <span class="text-cyan-600 dark:text-cyan-400 font-semibold"> Because in crypto, information wants to be free.</span>
        </p>
        
        {/* CTA */}
        <div class="flex flex-col sm:flex-row gap-5 justify-center mb-12">
          <a href="#start-learning" 
             class="group relative px-8 py-4 bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold rounded-xl hover:shadow-2xl hover:shadow-cyan-500/40 transition-all duration-300 transform hover:-translate-y-1 text-center text-lg">
            <span class="relative z-10">🚀 START LEARNING FREE</span>
            <div class="absolute inset-0 rounded-xl bg-gradient-to-r from-cyan-500 to-blue-600 blur opacity-50 group-hover:opacity-70 transition-opacity"></div>
          </a>
          <a href="#why-free" 
             class="px-8 py-4 dark:bg-black/50 bg-white/50 backdrop-blur-sm border-2 border-cyan-500/30 dark:text-white text-gray-900 font-bold rounded-xl hover:bg-cyan-500/10 hover:border-cyan-500 transition-all duration-300 text-center text-lg">
            🤔 WHY FREE?
          </a>
        </div>
        
        {/* Realistic Stats */}
        <div class="dark:bg-black/30 bg-white/50 backdrop-blur-sm rounded-2xl dark:border border-gray-800 border-gray-200 p-6 max-w-3xl mx-auto">
          <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
            <div class="text-center">
              <div class="text-3xl font-bold dark:text-white text-gray-900 mb-2">{realisticStats.guidesPublished}</div>
              <div class="dark:text-gray-400 text-gray-600 text-sm">GUIDES PUBLISHED</div>
            </div>
            <div class="text-center">
              <div class="text-3xl font-bold dark:text-white text-gray-900 mb-2">{realisticStats.activeReaders}</div>
              <div class="dark:text-gray-400 text-gray-600 text-sm">ACTIVE READERS</div>
            </div>
            <div class="text-center">
              <div class="text-3xl font-bold dark:text-white text-gray-900 mb-2">{realisticStats.protocolsCovered}</div>
              <div class="dark:text-gray-400 text-gray-600 text-sm">PROTOCOLS COVERED</div>
            </div>
            <div class="text-center">
              <div class="text-3xl font-bold dark:text-white text-gray-900 mb-2">$0</div>
              <div class="text-green-500 dark:text-green-400 text-sm">EVERYTHING COSTS</div>
            </div>
          </div>
        </div>
        
        {/* Trust Note */}
        <p class="dark:text-gray-500 text-gray-600 text-sm mt-8 max-w-xl mx-auto">
          ⚠️ <span class="dark:text-gray-400 text-gray-700">No upsells. No "premium tiers." Just knowledge.</span>
        </p>
      </div>
    </div>
  </section>

  <!-- Add these styles - REMOVED .dark selectors from CSS -->
  <style>
    /* Stars */
    .stars {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(2px 2px at 20px 30px, #eee, transparent),
        radial-gradient(2px 2px at 40px 70px, #fff, transparent),
        radial-gradient(1px 1px at 90px 40px, #ddd, transparent),
        radial-gradient(1px 1px at 130px 80px, #fff, transparent),
        radial-gradient(2px 2px at 160px 20px, #ddd, transparent),
        radial-gradient(1px 1px at 200px 120px, #fff, transparent),
        radial-gradient(2px 2px at 250px 60px, #eee, transparent),
        radial-gradient(1px 1px at 300px 100px, #ddd, transparent),
        radial-gradient(2px 2px at 350px 30px, #fff, transparent),
        radial-gradient(1px 1px at 400px 150px, #eee, transparent),
        radial-gradient(2px 2px at 450px 80px, #fff, transparent),
        radial-gradient(1px 1px at 500px 40px, #ddd, transparent),
        radial-gradient(2px 2px at 550px 130px, #eee, transparent),
        radial-gradient(1px 1px at 600px 70px, #fff, transparent);
      background-repeat: repeat;
      background-size: 800px 800px;
      animation: twinkle-slow 8s infinite;
    }
    
    .stars-2 {
      animation-delay: 2s;
      opacity: 0.6;
      background-size: 900px 900px;
      animation-duration: 10s;
    }
    
    .stars-3 {
      animation-delay: 4s;
      opacity: 0.4;
      background-size: 1000px 1000px;
      animation-duration: 12s;
    }
    
    /* Shooting Stars */
    .shooting-star {
      position: absolute;
      top: 0;
      left: -100px;
      width: 120px;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(96, 165, 250, 0.4), transparent);
      animation: shooting-star-slow 30s linear infinite;
    }
    
    .shooting-star-2 {
      top: 25%;
      animation-delay: 10s;
      animation-duration: 35s;
    }
    
    .shooting-star-3 {
      top: 65%;
      animation-delay: 20s;
      animation-duration: 40s;
    }
    
    /* Tachyon Particles */
    .particle-field {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
    }
    
    .particle {
      position: absolute;
      border-radius: 50%;
      animation: particle-float-slow linear infinite;
    }
    
    .particle-fast {
      width: 2px;
      height: 2px;
      background: rgba(139, 92, 246, 0.5);
      animation-duration: 8s;
      animation-timing-function: ease-in-out;
    }
    
    .particle-fast-2 {
      top: 15%;
      left: 15%;
      animation-delay: 2s;
      animation-duration: 10s;
    }
    
    .particle-fast-3 {
      top: 70%;
      left: 85%;
      animation-delay: 5s;
      animation-duration: 12s;
    }
    
    .particle-slow {
      width: 1px;
      height: 1px;
      background: rgba(59, 130, 246, 0.3);
      animation-duration: 20s;
      animation-timing-function: ease-in-out;
    }
    
    .particle-slow-2 {
      top: 35%;
      left: 25%;
      animation-delay: 3s;
      animation-duration: 25s;
    }
    
    .particle-slow-3 {
      top: 85%;
      left: 55%;
      animation-delay: 7s;
      animation-duration: 30s;
    }
    
    /* Particle trails for tachyon effect - subtler */
    .particle-fast::after {
      content: '';
      position: absolute;
      top: 0;
      left: -15px;
      width: 15px;
      height: 1px;
      background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.2));
    }
    
    @keyframes twinkle-slow {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 0.9; }
    }
    
    @keyframes shooting-star-slow {
      0% {
        transform: translateX(0) translateY(0) rotate(30deg);
        opacity: 0;
      }
      5% {
        opacity: 0.6;
      }
      15% {
        transform: translateX(100vw) translateY(80px) rotate(30deg);
        opacity: 0;
      }
      100% {
        opacity: 0;
      }
    }
    
    @keyframes particle-float-slow {
      0% {
        transform: translateX(0) translateY(0);
        opacity: 0;
      }
      10% {
        opacity: 0.6;
      }
      90% {
        opacity: 0.6;
      }
      100% {
        transform: translateX(100vw) translateY(80vh);
        opacity: 0;
      }
    }
    
    /* Slower pulse animations */
    @keyframes pulse-slow {
      0%, 100% { opacity: 0.03; }
      50% { opacity: 0.08; }
    }
    
    @keyframes pulse-slower {
      0%, 100% { opacity: 0.02; }
      50% { opacity: 0.05; }
    }
    
    .animate-pulse-slow {
      animation: pulse-slow 6s ease-in-out infinite;
    }
    
    .animate-pulse-slower {
      animation: pulse-slower 8s ease-in-out infinite;
    }
  </style>

  <!-- 🤔 "WHY FREE?" SECTION -->
  <section id="why-free" class="py-20 dark:bg-black bg-white relative overflow-hidden">
    <!-- Space background for dark mode (non-animated) -->
    <div class="absolute inset-0 bg-black hidden dark:block">
      <!-- Static space background without stars -->
      <div class="absolute inset-0">
        <!-- Nebula/Galaxy Effects (static) -->
        <div class="absolute w-[800px] h-[800px] bg-gradient-to-r from-purple-500/5 via-blue-500/5 to-cyan-500/5 rounded-full blur-3xl top-1/4 left-1/4 opacity-50"></div>
        <div class="absolute w-[600px] h-[600px] bg-gradient-to-r from-blue-500/5 via-cyan-500/5 to-purple-500/5 rounded-full blur-3xl bottom-1/4 right-1/4 opacity-30"></div>
        
        <!-- Subtle stars (static, non-animated) -->
        <div class="absolute inset-0 opacity-30"
             style="background-image: 
               radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,0.5) 0%, transparent 50%),
               radial-gradient(1px 1px at 30% 50%, rgba(255,255,255,0.4) 0%, transparent 50%),
               radial-gradient(0.5px 0.5px at 60% 40%, rgba(255,255,255,0.3) 0%, transparent 50%),
               radial-gradient(0.5px 0.5px at 80% 80%, rgba(255,255,255,0.4) 0%, transparent 50%),
               radial-gradient(1px 1px at 40% 90%, rgba(255,255,255,0.5) 0%, transparent 50%),
               radial-gradient(0.5px 0.5px at 70% 10%, rgba(255,255,255,0.3) 0%, transparent 50%);
             background-size: 400px 400px;">
        </div>
      </div>
    </div>
    
    <div class="container relative z-10 mx-auto px-4">
      <div class="max-w-3xl mx-auto text-center">
        <h2 class="text-3xl md:text-4xl font-bold dark:text-white text-gray-900 mb-12">
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-cyan-500 to-purple-500 dark:from-cyan-400 dark:to-purple-400">
            Wait... Why Free?
          </span>
        </h2>
        
        <div class="dark:bg-black/40 bg-gray-100/50 backdrop-blur-sm rounded-3xl dark:border border-cyan-500/30 border-cyan-400/30 p-8 mb-8">
          <div class="text-6xl mb-6">🎯</div>
          <h3 class="text-2xl font-bold dark:text-white text-gray-900 mb-4">The Open Source Philosophy</h3>
          <p class="dark:text-gray-300 text-gray-700 text-lg mb-6">
            Crypto was built on <span class="text-cyan-600 dark:text-cyan-400">open source principles</span>. Knowledge should flow freely, not be locked behind paywalls.
          </p>
          <p class="dark:text-gray-400 text-gray-600">
            We believe when more people understand DeFi, the entire ecosystem grows. 
            <span class="text-green-600 dark:text-green-400 font-medium"> That's our "investment."</span>
          </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="dark:bg-black/30 bg-gray-100/50 backdrop-blur-sm rounded-2xl p-6 dark:border border-gray-800 border-gray-200">
            <div class="text-3xl mb-4">⚡</div>
            <h4 class="text-xl font-bold dark:text-white text-gray-900 mb-3">No Hidden Agenda</h4>
            <p class="dark:text-gray-400 text-gray-600 text-sm">
              We're not selling courses. Not promoting shitcoins. Just sharing what works.
            </p>
          </div>
          <div class="dark:bg-black/30 bg-gray-100/50 backdrop-blur-sm rounded-2xl p-6 dark:border border-gray-800 border-gray-200">
            <div class="text-3xl mb-4">🔓</div>
            <h4 class="text-xl font-bold dark:text-white text-gray-900 mb-3">Accessible to All</h4>
            <p class="dark:text-gray-400 text-gray-600 text-sm">
              Whether you have $100 or $100,000 - knowledge should be equally accessible.
            </p>
          </div>
          <div class="dark:bg-black/30 bg-gray-100/50 backdrop-blur-sm rounded-2xl p-6 dark:border border-gray-800 border-gray-200">
            <div class="text-3xl mb-4">🌱</div>
            <h4 class="text-xl font-bold dark:text-white text-gray-900 mb-3">Grow With Us</h4>
            <p class="dark:text-gray-400 text-gray-600 text-sm">
              We're building this in public. Your feedback shapes what we create next.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- 🎯 FEATURED POST -->
<section class="py-20 dark:bg-gradient-to-b dark:from-gray-900 dark:to-black bg-gradient-to-b from-white to-gray-100">
  <div class="container mx-auto px-4">
    <!-- Featured Deep Dive Header -->
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold dark:text-white text-gray-900 mb-4">
        <span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-pink-500 dark:from-purple-400 dark:to-pink-400">
          Featured Deep Dive
        </span>
      </h2>
      <p class="text-xl dark:text-gray-400 text-gray-600">
        Our latest premium guide, completely free
      </p>
    </div>
    
    <div class="dark:bg-gradient-to-r dark:from-black/80 dark:to-gray-900/80 bg-gradient-to-r from-white/80 to-gray-100/80 backdrop-blur-xl rounded-3xl dark:border border-purple-500/30 border-purple-400/30 overflow-hidden shadow-2xl">
      <div class="grid grid-cols-1 lg:grid-cols-2">
        <!-- Image Side -->
        <div class="relative min-h-[400px] lg:min-h-[500px] overflow-hidden">
          {featuredPost?.data?.image ? (
            <img
              src={featuredPost.data.image}
              alt={featuredPost.data.title}
              class="absolute inset-0 w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
              loading="eager"
            />
          ) : (
            <div class="absolute inset-0 bg-gradient-to-br from-purple-900 via-pink-800 to-blue-900"></div>
          )}
          <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
          <div class="absolute inset-0 bg-gradient-to-r from-black/30 to-transparent lg:hidden"></div>
          <div class="absolute inset-0 bg-gradient-to-l from-black/30 to-transparent hidden lg:block"></div>
          
          {/* Content Overlay on Image */}
          <div class="absolute bottom-0 left-0 right-0 p-6 lg:p-8">
            <div class="flex flex-wrap gap-2 mb-3">
              {featuredPost?.data?.tags?.slice(0, 3).map(tag => (
                <span class="px-3 py-1 bg-white/20 backdrop-blur-sm text-white text-xs font-bold rounded-full border border-white/30">
                  #{tag}
                </span>
              ))}
            </div>
            <div class="text-white font-bold text-sm opacity-90">
              ⏱️ {featuredPost?.data?.readTime || 10} min read • 🆓 100% Free
            </div>
          </div>
        </div>
        
        <!-- Content Side -->
        <div class="p-8 lg:p-10 flex flex-col justify-center">
          <div class="mb-6">
            <div class="inline-flex items-center gap-2 mb-4">
              <div class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full text-white font-bold text-sm">
                🔥 FEATURED DEEP DIVE
              </div>
              <div class="text-cyan-500 dark:text-cyan-400 text-sm font-semibold">
                ⭐ LATEST RELEASE
              </div>
            </div>
            
            <h2 class="text-3xl lg:text-4xl font-bold dark:text-white text-gray-900 mb-4 leading-tight">
              {featuredPost?.data?.title || "Latest Deep Dive"}
            </h2>
            
            <p class="text-lg dark:text-gray-300 text-gray-700 mb-6">
              {featuredPost?.data?.description || "Our most recent premium guide, completely free."}
            </p>
          </div>
          
          <div class="space-y-4 mt-auto">
            {featuredPost ? (
              <>
                <a href={`/blog/${featuredPost.slug}`} 
                   class="block w-full py-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white font-bold rounded-xl text-center hover:shadow-xl hover:shadow-purple-500/30 transition-all hover:scale-[1.02] group">
                  <span class="flex items-center justify-center gap-3">
                    👉 READ FREE DEEP DIVE
                    <svg class="w-5 h-5 transform group-hover:translate-x-2 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                    </svg>
                  </span>
                </a>
                <div class="text-center dark:text-gray-400 text-gray-600 text-sm">
                  📖 Complete step-by-step guide • Beginner to advanced
                </div>
              </>
            ) : (
              <div class="text-center py-8">
                <p class="dark:text-gray-400 text-gray-600">No posts published yet. Check back soon!</p>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
   <!-- 🚀 QUICK START SECTION -->
  <section id="start-learning" class="py-20 dark:bg-gradient-to-b dark:from-black dark:to-gray-900 bg-gradient-to-b from-white to-gray-100">
    <div class="container mx-auto px-4">
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold dark:text-white text-gray-900 mb-6">
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-green-500 to-cyan-500 dark:from-green-400 dark:to-cyan-400">
            Start Here → Get Results
          </span>
        </h2>
        <p class="text-xl dark:text-gray-400 text-gray-600 max-w-2xl mx-auto">
          No fluff. Just actionable guides you can complete today.
        </p>
      </div>
      
      {/* Quick Wins - Only This Section */}
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
        {quickWins && quickWins.length > 0 ? quickWins.map((post, index) => (
          <a href={`/blog/${post.slug}`} 
             class="group dark:bg-gradient-to-br dark:from-gray-900 dark:to-black bg-gradient-to-br from-white to-gray-50 dark:border border-gray-800 border-gray-200 rounded-2xl overflow-hidden hover:border-cyan-500 hover:shadow-lg hover:shadow-cyan-500/10 transition-all duration-300 hover:-translate-y-1 flex flex-col h-full">
            
            {/* Thumbnail Image Container */}
            <div class="relative h-40 md:h-48 overflow-hidden bg-gradient-to-br from-cyan-500/10 to-blue-500/10 dark:from-cyan-500/5 dark:to-blue-500/5">
              {post.data.image ? (
                <img
                  src={post.data.image}
                  alt={post.data.title}
                  class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"
                  loading="lazy"
                />
              ) : (
                <div class="absolute inset-0 flex items-center justify-center">
                  <div class="text-5xl opacity-20 dark:opacity-30">
                    {post.data.category === 'getting-started' ? '🚀' : 
                     post.data.category === 'security-privacy' ? '🔐' :
                     post.data.category === 'trading-investing' ? '📈' :
                     post.data.category === 'defi-yield' ? '🏦' :
                     '📚'}
                  </div>
                </div>
              )}
              {/* Gradient Overlay */}
              <div class="absolute inset-0 bg-gradient-to-t from-black/10 to-transparent"></div>
              
              {/* Category Badge */}
              <div class="absolute top-3 left-3">
                <span class="inline-block px-3 py-1 bg-gradient-to-r from-green-500 to-cyan-500 text-white text-xs font-bold rounded-full shadow-md">
                  {post.data.readTime <= 5 ? '⚡ QUICK START' : '🎯 GET STARTED'}
                </span>
              </div>
            </div>
            
            {/* Content */}
            <div class="p-5 flex-1 flex flex-col">
              <div class="mb-3">
                <div class="text-xs font-semibold text-cyan-600 dark:text-cyan-400 uppercase tracking-wider mb-1">
                  {post.data.category ? post.data.category.replace('-', ' ') : 'Guide'}
                </div>
                <h3 class="text-lg font-bold dark:text-white text-gray-900 mb-3 group-hover:text-cyan-500 dark:group-hover:text-cyan-400 transition-colors line-clamp-2">
                  {post.data.title}
                </h3>
              </div>
              
              <p class="dark:text-gray-400 text-gray-600 text-sm mb-4 flex-1 line-clamp-3">
                {post.data.description || 'Actionable guide to get started...'}
              </p>
              
              <div class="flex items-center justify-between mt-auto pt-4 border-t border-gray-200 dark:border-gray-800">
                <span class="text-cyan-500 dark:text-cyan-400 text-sm font-medium flex items-center gap-1">
                  READ NOW 
                  <svg class="w-4 h-4 transform group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3" />
                  </svg>
                </span>
                <span class="dark:text-gray-500 text-gray-400 text-xs bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">
                  {post.data.readTime} min
                </span>
              </div>
            </div>
          </a>
        )) : (
          <div class="col-span-4 text-center py-12">
            <div class="text-4xl mb-4 dark:text-gray-700 text-gray-300">📚</div>
            <h3 class="text-xl font-bold dark:text-gray-400 text-gray-500">No posts yet</h3>
            <p class="dark:text-gray-500 text-gray-400 mt-2">Check back soon for our first guides!</p>
          </div>
        )}
      </div>
    </div>
  </section>
      

  <!-- 🗺️ CATEGORIES SECTION -->
  <section class="py-20 dark:bg-black bg-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-16">
        <h2 class="text-3xl md:text-4xl font-bold dark:text-white text-gray-900 mb-6">
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-500 to-pink-500 dark:from-purple-400 dark:to-pink-400">
            Explore All 11 Learning Paths
          </span>
        </h2>
        <p class="text-xl dark:text-gray-400 text-gray-600 max-w-3xl mx-auto">
          Comprehensive coverage of every crypto niche. All free.
        </p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 max-w-6xl mx-auto">
        {Object.entries(CATEGORY_HIERARCHY).slice(0, 8).map(([category, data]) => (
          <div class="dark:bg-gradient-to-br dark:from-gray-900 dark:to-black bg-gradient-to-br from-white to-gray-50 dark:border border-gray-800 border-gray-200 rounded-2xl p-6 hover:border-cyan-500/30 transition-all hover:-translate-y-1">
            <div class="flex items-start gap-4 mb-4">
              <div class="text-2xl">{data.icon}</div>
              <div>
                <h3 class="text-lg font-bold dark:text-white text-gray-900 mb-1">{data.name}</h3>
                <p class="dark:text-gray-400 text-gray-600 text-xs">{categoryPostCounts[category] || 0} guides</p>
              </div>
            </div>
            
            <p class="dark:text-gray-400 text-gray-600 text-sm mb-6">
              {data.description}
            </p>
            
            <div class="space-y-3 mb-6">
              {categoryPosts[category] && categoryPosts[category].length > 0 ? categoryPosts[category].slice(0, 2).map(post => (
                <a href={`/blog/${post.slug}`} 
                   class="block p-3 dark:bg-black/30 bg-gray-100/50 rounded-lg hover:dark:bg-black/50 hover:bg-gray-200/50 transition-colors group">
                  <div class="dark:text-white text-gray-900 text-sm group-hover:text-cyan-500 dark:group-hover:text-cyan-400 transition-colors line-clamp-1">
                    {post.data.title}
                  </div>
                  <div class="dark:text-gray-500 text-gray-400 text-xs mt-1 flex justify-between">
                    <span>{post.data.readTime} min</span>
                    <span>{new Date(post.data.date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</span>
                  </div>
                </a>
              )) : (
                <div class="dark:text-gray-600 text-gray-400 text-sm italic p-3 dark:bg-black/20 bg-gray-100/30 rounded-lg">
                  Guides coming soon...
                </div>
              )}
            </div>
            
            <a href={`/categories/${category}`} 
               class="inline-flex items-center gap-2 text-sm font-medium dark:text-white text-gray-900 hover:text-cyan-500 dark:hover:text-cyan-400 transition-colors">
              Explore all {data.name.toLowerCase()} guides →
            </a>
          </div>
        ))}
      </div>
      
      {/* Show remaining 3 categories */}
      {Object.entries(CATEGORY_HIERARCHY).slice(8, 11).length > 0 && (
        <div class="mt-12 max-w-4xl mx-auto">
          <h3 class="text-2xl font-bold dark:text-white text-gray-900 mb-8 text-center">More Specialized Areas</h3>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            {Object.entries(CATEGORY_HIERARCHY).slice(8, 11).map(([category, data]) => (
              <a href={`/categories/${category}`}
                 class="group dark:bg-gradient-to-br dark:from-gray-900/50 dark:to-black/50 bg-gradient-to-br from-white/50 to-gray-50/50 dark:border border-gray-800 border-gray-200 rounded-2xl p-6 hover:border-purple-500/30 transition-all hover:-translate-y-1">
                <div class="flex items-center gap-3 mb-4">
                  <div class="text-2xl">{data.icon}</div>
                  <h4 class="text-lg font-bold dark:text-white text-gray-900 group-hover:text-purple-500 dark:group-hover:text-purple-400 transition-colors">
                    {data.name}
                  </h4>
                </div>
                <p class="dark:text-gray-400 text-gray-600 text-sm mb-4">
                  {data.description.substring(0, 80)}...
                </p>
                <div class="flex items-center justify-between">
                  <span class="text-purple-500 dark:text-purple-400 text-sm font-medium">
                    Explore →
                  </span>
                  <span class="dark:text-gray-500 text-gray-400 text-xs">
                    {categoryPostCounts[category] || 0} guides
                  </span>
                </div>
              </a>
            ))}
          </div>
        </div>
      )}
    </div>
  </section>
  <!-- ✨ EXCLUSIVE BONUS PILLARS SECTION -->
  <section class="py-20 dark:bg-gradient-to-b dark:from-gray-900 dark:to-black bg-gradient-to-b from-gray-50 to-white">
    <div class="container mx-auto px-4">
      <div class="text-center mb-16">
        <div class="inline-flex items-center gap-3 mb-4">
          <span class="text-4xl">✨</span>
          <h2 class="text-3xl md:text-4xl font-bold dark:text-white text-gray-900">
            <span class="text-transparent bg-clip-text bg-gradient-to-r from-yellow-500 to-orange-500 dark:from-yellow-400 dark:to-orange-400">
              Exclusive Bonus Pillars
            </span>
          </h2>
          <span class="text-4xl">✨</span>
        </div>
        <p class="text-xl dark:text-gray-400 text-gray-600 max-w-2xl mx-auto">
          Premium content for dedicated members
        </p>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto">
        <!-- Alpha & Insider Strategies -->
        <div class="relative group">
          <div class="absolute inset-0 bg-gradient-to-br from-yellow-500/10 via-orange-500/10 to-red-500/10 dark:from-yellow-500/5 dark:via-orange-500/5 dark:to-red-500/5 rounded-3xl blur-xl group-hover:blur-2xl transition-all duration-500"></div>
          <div class="relative dark:bg-gradient-to-br dark:from-gray-900 dark:to-black bg-gradient-to-br from-white to-gray-50 dark:border border-yellow-500/30 border-yellow-400/30 rounded-3xl p-8 hover:shadow-2xl hover:shadow-yellow-500/20 dark:hover:shadow-yellow-500/10 transition-all duration-300 hover:-translate-y-2">
            <div class="flex items-start justify-between mb-6">
              <div>
                <div class="inline-flex items-center gap-3 mb-3">
                  <div class="text-3xl">🔒</div>
                  <h3 class="text-2xl font-bold dark:text-white text-gray-900">
                    Alpha & Insider Strategies 🔒
                  </h3>
                </div>
                <p class="dark:text-gray-300 text-gray-700">
                  Exclusive early access plays, whitelist strategies, and high-frequency alpha
                </p>
              </div>
              <div class="px-4 py-2 bg-gradient-to-r from-yellow-600 to-orange-600 rounded-full text-white font-bold text-sm">
                MEMBER EXCLUSIVE
              </div>
            </div>
            
            <div class="mb-8">
              <h4 class="dark:text-gray-300 text-gray-700 font-semibold mb-4 text-lg">Premium Subcategories:</h4>
              <div class="grid grid-cols-2 gap-3">
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-yellow-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>⚡</span>
                  <span class="text-sm">Early DEX Arbitrage</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-yellow-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🎯</span>
                  <span class="text-sm">Memecoin & NFT Whitelists</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-yellow-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🔥</span>
                  <span class="text-sm">High-Frequency Airdrops</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-yellow-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🧠</span>
                  <span class="text-sm">Alpha Discovery Systems</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-yellow-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🕵️</span>
                  <span class="text-sm">Pre-Narrative Positioning</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-yellow-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🔍</span>
                  <span class="text-sm">On-Chain Insider Signals</span>
                </div>
              </div>
            </div>
            
            <div class="space-y-4">
              <div class="dark:bg-black/40 bg-yellow-50/30 rounded-xl p-4">
                <h4 class="dark:text-yellow-400 text-yellow-600 font-bold mb-2">🎁 Premium Access</h4>
                <p class="dark:text-gray-400 text-gray-600 text-sm">
                  Get exclusive access to these premium strategies and insider plays
                </p>
              </div>
              
              <button onclick="document.getElementById('subscribe-popup').showModal()" 
                      class="w-full py-4 bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-bold rounded-xl hover:shadow-xl hover:shadow-yellow-500/30 transition-all hover:scale-[1.02] flex items-center justify-center gap-3">
                <span>🔓</span>
                UNLOCK BONUS PILLARS
                <span>→</span>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Web3 Gaming & Metaverse -->
        <div class="relative group">
          <div class="absolute inset-0 bg-gradient-to-br from-blue-500/10 via-purple-500/10 to-pink-500/10 dark:from-blue-500/5 dark:via-purple-500/5 dark:to-pink-500/5 rounded-3xl blur-xl group-hover:blur-2xl transition-all duration-500"></div>
          <div class="relative dark:bg-gradient-to-br dark:from-gray-900 dark:to-black bg-gradient-to-br from-white to-gray-50 dark:border border-purple-500/30 border-purple-400/30 rounded-3xl p-8 hover:shadow-2xl hover:shadow-purple-500/20 dark:hover:shadow-purple-500/10 transition-all duration-300 hover:-translate-y-2">
            <div class="flex items-start justify-between mb-6">
              <div>
                <div class="inline-flex items-center gap-3 mb-3">
                  <div class="text-3xl">🎮</div>
                  <h3 class="text-2xl font-bold dark:text-white text-gray-900">
                    Web3 Gaming & Metaverse 🔒
                  </h3>
                </div>
                <p class="dark:text-gray-300 text-gray-700">
                  Insider gaming strategies, early access plays, and metaverse wealth building
                </p>
              </div>
              <div class="px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full text-white font-bold text-sm">
                MEMBER EXCLUSIVE
              </div>
            </div>
            
            <div class="mb-8">
              <h4 class="dark:text-gray-300 text-gray-700 font-semibold mb-4 text-lg">Premium Subcategories:</h4>
              <div class="grid grid-cols-2 gap-3">
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-purple-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🎮</span>
                  <span class="text-sm">Play-to-Earn Strategies</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-purple-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🌐</span>
                  <span class="text-sm">Metaverse Land & Real Estate</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-purple-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🏆</span>
                  <span class="text-sm">NFT Game Assets</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-purple-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>⚡</span>
                  <span class="text-sm">Early Access & Insider Play</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-purple-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>🔄</span>
                  <span class="text-sm">Cross-Game Strategies</span>
                </div>
                <div class="flex items-center gap-2 dark:bg-gray-800/50 bg-purple-50/50 dark:text-gray-300 text-gray-700 p-3 rounded-lg">
                  <span>👥</span>
                  <span class="text-sm">Guilds & Community</span>
                </div>
              </div>
            </div>
            
            <div class="space-y-4">
              <div class="dark:bg-black/40 bg-purple-50/30 rounded-xl p-4">
                <h4 class="dark:text-purple-400 text-purple-600 font-bold mb-2">🎁 Premium Access</h4>
                <p class="dark:text-gray-400 text-gray-600 text-sm">
                  Access gaming alpha, guild strategies, and metaverse investment plays
                </p>
              </div>
              
              <button onclick="document.getElementById('subscribe-popup').showModal()" 
                      class="w-full py-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold rounded-xl hover:shadow-xl hover:shadow-purple-500/30 transition-all hover:scale-[1.02] flex items-center justify-center gap-3">
                <span>🔓</span>
                UNLOCK BONUS PILLARS
                <span>→</span>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Why Bonus Pillars Section -->
      <div class="mt-12 max-w-3xl mx-auto">
        <div class="dark:bg-gradient-to-r dark:from-gray-900/50 dark:to-black/50 bg-gradient-to-r from-gray-100/50 to-white/50 backdrop-blur-sm rounded-2xl dark:border border-gray-800 border-gray-200 p-8">
          <div class="text-center mb-6">
            <h3 class="text-2xl font-bold dark:text-white text-gray-900 mb-4">
              Why Exclusive Bonus Pillars?
            </h3>
            <p class="dark:text-gray-300 text-gray-700">
              These pillars contain premium content that requires dedicated access
            </p>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="text-center p-4">
              <div class="text-2xl mb-3">⚡</div>
              <h4 class="font-bold dark:text-white text-gray-900 mb-2">Time-Sensitive Alpha</h4>
              <p class="dark:text-gray-400 text-gray-600 text-sm">
                Strategies that work best when you act fast
              </p>
            </div>
            <div class="text-center p-4">
              <div class="text-2xl mb-3">🤫</div>
              <h4 class="font-bold dark:text-white text-gray-900 mb-2">Insider Strategies</h4>
              <p class="dark:text-gray-400 text-gray-600 text-sm">
                Plays that lose edge if shared too widely
              </p>
            </div>
            <div class="text-center p-4">
              <div class="text-2xl mb-3">🎯</div>
              <h4 class="font-bold dark:text-white text-gray-900 mb-2">Premium Content</h4>
              <p class="dark:text-gray-400 text-gray-600 text-sm">
                High-value strategies for dedicated members
              </p>
            </div>
          </div>
          
          <div class="text-center mt-8">
            <p class="dark:text-gray-400 text-gray-600 text-sm italic">
              The 11 main pillars remain 100% free. These bonus pillars contain premium content for dedicated members.
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- 📚 LATEST GUIDES SECTION -->
  <section class="py-20 dark:bg-gradient-to-b dark:from-gray-900 dark:to-black bg-gradient-to-b from-gray-100 to-white">
    <div class="container mx-auto px-4">
      <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center mb-12 gap-6">
        <div>
          

          <h2 class="text-3xl lg:text-4xl font-bold dark:text-white text-gray-900">
            Latest Deep Dives
          </h2>
          <p class="dark:text-gray-400 text-gray-600 mt-2">
            Fresh research & analysis published regularly
          </p>
        </div>
        <a href="/blog" 
           class="px-6 py-3 dark:bg-gray-800 bg-gray-200 dark:hover:bg-gray-700 hover:bg-gray-300 dark:text-white text-gray-900 font-semibold rounded-xl transition-colors flex items-center gap-2">
          <span>📚</span> View All Guides
        </a>
      </div>
      
      {latestPosts && latestPosts.length > 0 ? (
        <>
          <Posts posts={latestPosts} className="mb-12" />
          <div class="text-center">
            <Pagination currentPage={1} totalPages={Math.ceil(allPosts.length / 6)} />
          </div>
        </>
      ) : (
        <div class="text-center py-16">
          <div class="text-5xl mb-6 dark:text-gray-700 text-gray-300">📖</div>
          <h3 class="text-2xl font-bold dark:text-gray-400 text-gray-500 mb-4">No posts yet</h3>
          <p class="dark:text-gray-500 text-gray-400">Our first guides will be published soon!</p>
        </div>
      )}
    </div>
  </section>

  <!-- 🎁 FINAL CTA -->
  <section class="py-20 dark:bg-gradient-to-r dark:from-black dark:via-purple-900/20 dark:to-blue-900/20 bg-gradient-to-r from-white via-purple-50/20 to-blue-50/20">
    <div class="container mx-auto px-4">
      <div class="max-w-3xl mx-auto text-center">
        <div class="dark:bg-black/40 bg-white/40 backdrop-blur-sm rounded-3xl dark:border border-cyan-500/30 border-cyan-400/30 p-8 lg:p-10">
          <div class="text-5xl mb-6">🎁</div>
          
          <h2 class="text-3xl md:text-4xl font-bold dark:text-white text-gray-900 mb-6">
            Seriously. It's All Free.
          </h2>
          
          <p class="dark:text-gray-300 text-gray-700 text-lg mb-8">
            No credit card. No "free trial" that expires. No premium tier waiting. 
            <span class="text-cyan-600 dark:text-cyan-400 font-medium"> Just quality DeFi education.</span>
          </p>
          
          <div class="space-y-4">
            <a href="/blog" 
               class="block w-full py-4 bg-gradient-to-r from-cyan-500 to-blue-600 text-white font-bold rounded-xl text-lg hover:shadow-xl hover:shadow-cyan-500/30 transition-all">
              BROWSE ALL FREE GUIDES
            </a>
            
            <p class="dark:text-gray-500 text-gray-600 text-sm">
              ⚡ Join {realisticStats.activeReaders} others learning DeFi the right way
            </p>
          </div>
          
          {/* Disclaimer */}
          <div class="mt-8 pt-6 dark:border-t border-gray-800 border-gray-200">
            <p class="dark:text-gray-600 text-gray-500 text-xs">
              ⚠️ <span class="dark:text-gray-500 text-gray-600">Disclaimer: We're not financial advisors. DeFi has risks. 
              We just believe knowledge should be free. Do your own research.</span>
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- NEWSLETTER POPUP -->
<dialog id="subscribe-popup" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); padding: 20px; border: none; border-radius: 12px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); max-width: 500px; width: 90%; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: white; z-index: 9999; margin: 0;">
  <div style="text-align: center; padding: 20px;">
    <div style="font-size: 48px; margin-bottom: 16px;">🚀</div>
    <h2 style="font-size: 24px; font-weight: bold; margin-bottom: 12px; color: #60a5fa;">Stay Ahead in Crypto</h2>
    <p style="color: #cbd5e1; margin-bottom: 20px; line-height: 1.5;">
      Get exclusive DeFi insights, airdrop alerts & alpha directly to your inbox.<br>
      <span style="color: #10b981; font-weight: 600;">No spam, just pure value.</span>
    </p>
    
    <script async src="https://subscribe-forms.beehiiv.com/embed.js"></script>
    <iframe 
      src="https://subscribe-forms.beehiiv.com/62d85daa-7878-4a83-a78a-a15f6226c516" 
      class="beehiiv-embed" 
      data-test-id="beehiiv-embed" 
      frameborder="0" 
      scrolling="no" 
      style="width: 508px; height: 198px; margin: 0; border-radius: 0px !important; background-color: transparent; box-shadow: 0 0 #0000; max-width: 100%;">
    </iframe>
    
    <button id="close-popup" style="margin-top: 20px; padding: 10px 20px; background: #374151; color: #d1d5db; border: none; border-radius: 8px; cursor: pointer; font-weight: 500; transition: all 0.2s ease;">
      No thanks, I'll miss out on alpha
    </button>
  </div>
</dialog>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const popup = document.getElementById('subscribe-popup');
    const closeButton = document.getElementById('close-popup');
    
    // Track if popup has been shown
    let popupShown = false;
    let scrollListenerAdded = false;
    
    // Function to calculate scroll percentage (FIXED)
    function getScrollPercent() {
      const scrollTop = window.scrollY || document.documentElement.scrollTop;
      const docHeight = Math.max(
        document.body.scrollHeight,
        document.body.offsetHeight,
        document.documentElement.clientHeight,
        document.documentElement.scrollHeight,
        document.documentElement.offsetHeight
      );
      const winHeight = window.innerHeight;
      const scrollable = docHeight - winHeight;
      
      if (scrollable <= 0) return 0;
      
      const scrollPercent = (scrollTop / scrollable) * 100;
      return scrollPercent;
    }
    
    // Function to show popup
    function showPopup() {
      if (!popupShown && !localStorage.getItem('popupShownToday')) {
        console.log('Showing popup!');
        popup.showModal();
        popupShown = true;
        
        // Store in localStorage for 24 hours
        const now = new Date();
        localStorage.setItem('popupShownToday', now.toISOString());
        
        // Remove scroll listener after showing
        if (scrollListenerAdded) {
          window.removeEventListener('scroll', checkScrollForPopup);
        }
      }
    }
    
    // Check scroll position
    function checkScrollForPopup() {
      const scrollPercent = getScrollPercent();
      
      if (scrollPercent >= 50 && !popupShown) {
        console.log('50% scroll reached, showing popup');
        showPopup();
      }
    }
    
    // Add scroll listener
    if (!scrollListenerAdded) {
      window.addEventListener('scroll', checkScrollForPopup);
      scrollListenerAdded = true;
      
      // Also check immediately in case page is already scrolled
      setTimeout(checkScrollForPopup, 100);
    }
    
    // Fallback: Show after 30 seconds if not shown yet
    const fallbackTimeout = setTimeout(() => {
      if (!popupShown && !localStorage.getItem('popupShownToday')) {
        console.log('30-second fallback, showing popup');
        showPopup();
      }
    }, 30000);
    
    // Close button handler
    closeButton.addEventListener('click', () => {
      popup.close();
      clearTimeout(fallbackTimeout);
    });
    
    // Close on outside click
    popup.addEventListener('click', (event) => {
      if (event.target === popup) {
        popup.close();
        clearTimeout(fallbackTimeout);
      }
    });
    
    // Close on Escape key
    document.addEventListener('keydown', (event) => {
      if (event.key === 'Escape' && popup.open) {
        popup.close();
        clearTimeout(fallbackTimeout);
      }
    });
    
    // Check localStorage expiry (clear after 24 hours)
    const lastShown = localStorage.getItem('popupShownToday');
    if (lastShown) {
      const lastShownDate = new Date(lastShown);
      const now = new Date();
      const hoursDiff = (now - lastShownDate) / (1000 * 60 * 60);
      
      if (hoursDiff >= 24) {
        localStorage.removeItem('popupShownToday');
        console.log('Cleared 24-hour popup restriction');
      }
    }
  });
</script>

<!-- Add the beautiful animations -->
<style>
  @keyframes gradient {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }
  
  .animate-gradient {
    background-size: 200% 200%;
    animation: gradient 4s ease infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
  
  .animate-pulse {
    animation: pulse 3s ease-in-out infinite;
  }
  
  .animation-delay-2000 {
    animation-delay: 2s;
  }
  
  /* Smooth hover effects */
  * {
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Line clamp utility */
  .line-clamp-1 {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }
  
  /* Newsletter popup styles */
  #subscribe-popup {
    position: fixed !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin: 0 !important;
    z-index: 9999 !important;
  }
  
  #subscribe-popup::backdrop {
    background: rgba(0, 0, 0, 0.8);
    backdrop-filter: blur(5px);
    animation: fadeIn 0.3s ease;
  }
  
  #subscribe-popup {
    animation: slideIn 0.3s ease;
    border: 1px solid rgba(59, 130, 246, 0.3) !important;
  }
  
  #close-popup:hover {
    background: #4b5563 !important;
    transform: translateY(-1px);
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  @keyframes slideIn {
    from { 
      opacity: 0;
      transform: translate(-50%, -40%) scale(0.95) !important;
    }
    to { 
      opacity: 1;
      transform: translate(-50%, -50%) scale(1) !important;
    }
  }
</style>
</Base>